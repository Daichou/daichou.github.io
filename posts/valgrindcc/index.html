<!DOCTYPE html>
<html lang="zh-tw">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.68.0 with theme Tranquilpeak 0.4.7-BETA">
<meta name="author" content="Dai chou">
<meta name="keywords" content="">
<meta name="description" content="Valgrind:C/C&#43;&#43;分析工具 Valgrind是開源的測試框架，可以用來動態分析記憶體配置、快取使用、多執行序bug。
安裝 $ sudo pacman -Sy valgrind 基本用法 $ valgrind 程式名稱 args 預設會是用memcheck工具分析，在這個工具下她會匯出heap使用、memory leak、還有記憶體使用錯誤的部份backtrace。 進階用法 $ valgrind --tool=toolname 程式名稱 args 這是valgrind最有方便的地方，valgrind旗下有九個使用者端的工具，和幾個開發者工具。 1. Memcheck:記憶體錯誤分析工具。 2.Cachegrind:預測你的cache使用。 3.Callgrind:分析程式的function call次數，還有call graph，可以幫助快取分析。 4.Helgrind:多執行序錯誤分析工具，有race condition檢測功能。 5.DRD:另一個多執行序分析工具。 6.Massif:分析heap的使用，在一個程式執行中她會測量多次。 7.DHAT:另一種heap分析工具。 8.SGcheck:實驗性的全域變數與stack分析工具。 9.BBV:實驗性SimPoint相關工具。 這些工具比較常用的是前七個。接下來看一下個別的使用。 memcheck $ valgrind --tool=memcheck 程式名稱 args 首先我先寫一個廢物code來做實驗。以下code new完之後沒有delete。
#include&lt;iostream&gt; using namespace std; int main() { int *ptr; ptr = new int; *ptr = 2; cout &lt;&lt; *ptr &lt;&lt; endl; } 然後我們來看一下分析結果。
==12313== Memcheck, a memory error detector ==12313== Copyright (C) 2002-2015, and GNU GPL&#39;d, by Julian Seward et al.">


<meta property="og:description" content="Valgrind:C/C&#43;&#43;分析工具 Valgrind是開源的測試框架，可以用來動態分析記憶體配置、快取使用、多執行序bug。
安裝 $ sudo pacman -Sy valgrind 基本用法 $ valgrind 程式名稱 args 預設會是用memcheck工具分析，在這個工具下她會匯出heap使用、memory leak、還有記憶體使用錯誤的部份backtrace。 進階用法 $ valgrind --tool=toolname 程式名稱 args 這是valgrind最有方便的地方，valgrind旗下有九個使用者端的工具，和幾個開發者工具。 1. Memcheck:記憶體錯誤分析工具。 2.Cachegrind:預測你的cache使用。 3.Callgrind:分析程式的function call次數，還有call graph，可以幫助快取分析。 4.Helgrind:多執行序錯誤分析工具，有race condition檢測功能。 5.DRD:另一個多執行序分析工具。 6.Massif:分析heap的使用，在一個程式執行中她會測量多次。 7.DHAT:另一種heap分析工具。 8.SGcheck:實驗性的全域變數與stack分析工具。 9.BBV:實驗性SimPoint相關工具。 這些工具比較常用的是前七個。接下來看一下個別的使用。 memcheck $ valgrind --tool=memcheck 程式名稱 args 首先我先寫一個廢物code來做實驗。以下code new完之後沒有delete。
#include&lt;iostream&gt; using namespace std; int main() { int *ptr; ptr = new int; *ptr = 2; cout &lt;&lt; *ptr &lt;&lt; endl; } 然後我們來看一下分析結果。
==12313== Memcheck, a memory error detector ==12313== Copyright (C) 2002-2015, and GNU GPL&#39;d, by Julian Seward et al.">
<meta property="og:type" content="article">
<meta property="og:title" content="Valgrind:C/C&#43;&#43;分析工具">
<meta name="twitter:title" content="Valgrind:C/C&#43;&#43;分析工具">
<meta property="og:url" content="https://daichou.github.io/posts/valgrindcc/">
<meta property="twitter:url" content="https://daichou.github.io/posts/valgrindcc/">
<meta property="og:site_name" content="gattaca-ngin">
<meta property="og:description" content="Valgrind:C/C&#43;&#43;分析工具 Valgrind是開源的測試框架，可以用來動態分析記憶體配置、快取使用、多執行序bug。
安裝 $ sudo pacman -Sy valgrind 基本用法 $ valgrind 程式名稱 args 預設會是用memcheck工具分析，在這個工具下她會匯出heap使用、memory leak、還有記憶體使用錯誤的部份backtrace。 進階用法 $ valgrind --tool=toolname 程式名稱 args 這是valgrind最有方便的地方，valgrind旗下有九個使用者端的工具，和幾個開發者工具。 1. Memcheck:記憶體錯誤分析工具。 2.Cachegrind:預測你的cache使用。 3.Callgrind:分析程式的function call次數，還有call graph，可以幫助快取分析。 4.Helgrind:多執行序錯誤分析工具，有race condition檢測功能。 5.DRD:另一個多執行序分析工具。 6.Massif:分析heap的使用，在一個程式執行中她會測量多次。 7.DHAT:另一種heap分析工具。 8.SGcheck:實驗性的全域變數與stack分析工具。 9.BBV:實驗性SimPoint相關工具。 這些工具比較常用的是前七個。接下來看一下個別的使用。 memcheck $ valgrind --tool=memcheck 程式名稱 args 首先我先寫一個廢物code來做實驗。以下code new完之後沒有delete。
#include&lt;iostream&gt; using namespace std; int main() { int *ptr; ptr = new int; *ptr = 2; cout &lt;&lt; *ptr &lt;&lt; endl; } 然後我們來看一下分析結果。
==12313== Memcheck, a memory error detector ==12313== Copyright (C) 2002-2015, and GNU GPL&#39;d, by Julian Seward et al.">
<meta name="twitter:description" content="Valgrind:C/C&#43;&#43;分析工具 Valgrind是開源的測試框架，可以用來動態分析記憶體配置、快取使用、多執行序bug。
安裝 $ sudo pacman -Sy valgrind 基本用法 $ valgrind 程式名稱 args 預設會是用memcheck工具分析，在這個工具下她會匯出heap使用、memory leak、還有記憶體使用錯誤的部份backtrace。 進階用法 $ valgrind --tool=toolname 程式名稱 args 這是valgrind最有方便的地方，valgrind旗下有九個使用者端的工具，和幾個開發者工具。 1. Memcheck:記憶體錯誤分析工具。 2.Cachegrind:預測你的cache使用。 3.Callgrind:分析程式的function call次數，還有call graph，可以幫助快取分析。 4.Helgrind:多執行序錯誤分析工具，有race condition檢測功能。 5.DRD:另一個多執行序分析工具。 6.Massif:分析heap的使用，在一個程式執行中她會測量多次。 7.DHAT:另一種heap分析工具。 8.SGcheck:實驗性的全域變數與stack分析工具。 9.BBV:實驗性SimPoint相關工具。 這些工具比較常用的是前七個。接下來看一下個別的使用。 memcheck $ valgrind --tool=memcheck 程式名稱 args 首先我先寫一個廢物code來做實驗。以下code new完之後沒有delete。
#include&lt;iostream&gt; using namespace std; int main() { int *ptr; ptr = new int; *ptr = 2; cout &lt;&lt; *ptr &lt;&lt; endl; } 然後我們來看一下分析結果。
==12313== Memcheck, a memory error detector ==12313== Copyright (C) 2002-2015, and GNU GPL&#39;d, by Julian Seward et al.">
<meta property="og:locale" content="en">

  
    <meta property="article:published_time" content="2017-01-13T22:05:00">
  
  
    <meta property="article:modified_time" content="2017-01-13T22:05:00">
  
  
  
  
    
      <meta property="article:tag" content="Note">
    
  


<meta name="twitter:card" content="summary">











  <meta property="og:image" content="https://www.gravatar.com/avatar/b4129e5955793d76911ddfa9909e0f60?s=640">
  <meta property="twitter:image" content="https://www.gravatar.com/avatar/b4129e5955793d76911ddfa9909e0f60?s=640">


    <title>Valgrind:C/C&#43;&#43;分析工具</title>

    <link rel="icon" href="https://daichou.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://daichou.github.io/posts/valgrindcc/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://daichou.github.io/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-161437179-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="1">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://daichou.github.io/">gattaca-ngin</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://daichou.github.io/#about">
    
    
    
      
        <img class="header-picture" src="https://www.gravatar.com/avatar/b4129e5955793d76911ddfa9909e0f60?s=90" alt="" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="1">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://daichou.github.io/#about">
          <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/b4129e5955793d76911ddfa9909e0f60?s=110" alt="" />
        </a>
        <h4 class="sidebar-profile-name">Dai chou</h4>
        
          <h5 class="sidebar-profile-bio">A student major in Computer science in National Chiao Tung University.</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://daichou.github.io/posts">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://daichou.github.io/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://daichou.github.io/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://daichou.github.io/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://daichou.github.io/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/Daichou" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://daichou.github.io/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="1"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Valgrind:C/C&#43;&#43;分析工具
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2017-01-13T22:05:00-08:00">
        
   13, 2017

      </time>
    
    
  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <h1 id="valgrindcc分析工具"><strong>Valgrind:C/C++分析工具</strong></h1>
<p>Valgrind是開源的測試框架，可以用來動態分析記憶體配置、快取使用、多執行序bug。</p>
<h2 id="安裝"><strong>安裝</strong></h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ sudo pacman -Sy valgrind
</code></pre></div><h2 id="基本用法"><strong>基本用法</strong></h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ valgrind 程式名稱 args
</code></pre></div><h5 id="預設會是用memcheck工具分析在這個工具下她會匯出heap使用memory-leak還有記憶體使用錯誤的部份backtrace">預設會是用memcheck工具分析，在這個工具下她會匯出heap使用、memory leak、還有記憶體使用錯誤的部份backtrace。</h5>
<h2 id="進階用法"><strong>進階用法</strong></h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ valgrind --tool<span style="color:#f92672">=</span>toolname 程式名稱 args
</code></pre></div><h5 id="這是valgrind最有方便的地方valgrind旗下有九個使用者端的工具和幾個開發者工具">這是valgrind最有方便的地方，valgrind旗下有九個使用者端的工具，和幾個開發者工具。</h5>
<h4 id="1-memcheck記憶體錯誤分析工具">1. <strong>Memcheck</strong>:記憶體錯誤分析工具。</h4>
<h4 id="2cachegrind預測你的cache使用">2.<strong>Cachegrind</strong>:預測你的cache使用。</h4>
<h4 id="3callgrind分析程式的function-call次數還有call-graph可以幫助快取分析">3.<strong>Callgrind</strong>:分析程式的function call次數，還有call graph，可以幫助快取分析。</h4>
<h4 id="4helgrind多執行序錯誤分析工具有race-condition檢測功能">4.<strong>Helgrind</strong>:多執行序錯誤分析工具，有race condition檢測功能。</h4>
<h4 id="5drd另一個多執行序分析工具">5.<strong>DRD</strong>:另一個多執行序分析工具。</h4>
<h4 id="6massif分析heap的使用在一個程式執行中她會測量多次">6.<strong>Massif</strong>:分析heap的使用，在一個程式執行中她會測量多次。</h4>
<h4 id="7dhat另一種heap分析工具">7.<strong>DHAT</strong>:另一種heap分析工具。</h4>
<h4 id="8sgcheck實驗性的全域變數與stack分析工具">8.<strong>SGcheck</strong>:實驗性的全域變數與stack分析工具。</h4>
<h4 id="9bbv實驗性simpoint相關工具">9.<strong>BBV</strong>:實驗性SimPoint相關工具。</h4>
<h5 id="這些工具比較常用的是前七個接下來看一下個別的使用">這些工具比較常用的是前七個。接下來看一下個別的使用。</h5>
<h3 id="memcheck"><strong>memcheck</strong></h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ valgrind --tool<span style="color:#f92672">=</span>memcheck 程式名稱 args
</code></pre></div><p>首先我先寫一個廢物code來做實驗。以下code new完之後沒有delete。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;iostream&gt;  </span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;  
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()  
{  
    <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>ptr;  
    ptr <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">int</span>;  
    <span style="color:#f92672">*</span>ptr <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;  
    cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#f92672">*</span>ptr <span style="color:#f92672">&lt;&lt;</span> endl;  
}  

</code></pre></div><p>然後我們來看一下分析結果。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">==12313== Memcheck, a memory error detector  
==12313== Copyright (C) 2002-2015, and GNU GPL&#39;d, by Julian Seward et al.  
==12313== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info  
==12313== Command: ./garbage  
==12313==  
2  
==12313==  
==12313== HEAP SUMMARY:  
==12313== in use at exit: 4 bytes in 1 blocks  
==12313== total heap usage: 3 allocs, 2 frees, 73,732 bytes allocated  
==12313==  
==12313== LEAK SUMMARY:  
==12313== definitely lost: 4 bytes in 1 blocks  
==12313== indirectly lost: 0 bytes in 0 blocks  
==12313== possibly lost: 0 bytes in 0 blocks  
==12313== still reachable: 0 bytes in 0 blocks  
==12313== suppressed: 0 bytes in 0 blocks  
==12313== Rerun with --leak-check=full to see details of leaked memory  
==12313==  
==12313== For counts of detected and suppressed errors, rerun with: -v  
==12313== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)
</code></pre></div><p>她寫了<code>definitely lost: 4 bytes in 1 blocks</code>，int是4 byte，我new完之後沒有回收所以memory leak了4 byte，不過由於這程式很間單所以很好找到錯誤來源，當程式變得複雜時我們可以加上<code>--leak-check=full</code>來找到源頭，來看一加完的結果。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">==14268== Memcheck, a memory error detector  
==14268== Copyright (C) 2002-2015, and GNU GPL&#39;d, by Julian Seward et al.  
==14268== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info  
==14268== Command: ./garbage  
==14268==  
2  
==14268==  
==14268== HEAP SUMMARY:  
==14268== in use at exit: 4 bytes in 1 blocks  
==14268== total heap usage: 3 allocs, 2 frees, 73,732 bytes allocated  
==14268==  
==14268== 4 bytes in 1 blocks are definitely lost in loss record 1 of 1  
==14268== at 0x4C2B1EC: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)  
==14268== by 0x4007C7: main (in /home/tommycc/garbage)  
==14268==  
==14268== LEAK SUMMARY:  
==14268== definitely lost: 4 bytes in 1 blocks  
==14268== indirectly lost: 0 bytes in 0 blocks  
==14268== possibly lost: 0 bytes in 0 blocks  
==14268== still reachable: 0 bytes in 0 blocks  
==14268== suppressed: 0 bytes in 0 blocks  
==14268==  
==14268== For counts of detected and suppressed errors, rerun with: -v  
==14268== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)  
</code></pre></div><p>可以發現這兩行，指出了錯誤點。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">==14268== at 0x4C2B1EC: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)  
==14268== by 0x4007C7: main (in /home/tommycc/garbage)  
</code></pre></div><h3 id="cachegrind"><strong>Cachegrind</strong></h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$valgrind --tool<span style="color:#f92672">=</span>cachegrind
</code></pre></div><p>它可以分析你程式的快取優化程度。它的結果總共有以下類別。以下擷取至valgrind manual</p>
<ul>
<li>I cache reads (Ir, which equals the number of instructions executed), I1 cache read misses (I1mr) and LL cache instruction read misses (ILmr).</li>
<li>D cache reads (Dr, which equals the number of memory reads), D1 cache read misses (D1mr), and LL cache data read misses (DLmr).</li>
<li>D cache writes (Dw, which equals the number of memory writes), D1 cache write misses (D1mw), and LL cache data write misses (DLmw).</li>
<li>Conditional branches executed (Bc) and conditional branches mispredicted (Bcm).</li>
<li>Indirect branches executed (Bi) and indirect branches mispredicted (Bim).</li>
</ul>
<p>一般來說I和D是首要分析的部份。以下的範例是二維陣列存取，我們都知道二維陣列在記憶體上其實是一維的，所以(row major)先row在column會比(column major)先column在row快。我們先執行row major的code如以下。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"> <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> ; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1000</span> ; i<span style="color:#f92672">++</span> ){                                                                      
     <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> ; j <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1000</span> ; j<span style="color:#f92672">++</span> ){                                        
         a[i][j] <span style="color:#f92672">=</span> i<span style="color:#f92672">+</span>j;                                                        
     }                                                                         
 } 
</code></pre></div><p>結果如下。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">==11719== Cachegrind, a cache and branch-prediction profiler  
==11719== Copyright (C) 2002-2015, and GNU GPL&#39;d, by Nicholas Nethercote et al.  
==11719== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info  
==11719== Command: ./tt  
==11719==   
--11719-- warning: L3 cache found, using its data for the LL simulation.  
==11719==   
==11719== I   refs:      16,204,946  
==11719== I1  misses:         1,401  
==11719== LLi misses:         1,357  
==11719== I1  miss rate:       0.01%  
==11719== LLi miss rate:       0.01%  
==11719==   
==11719== D   refs:       7,729,575  (6,536,262 rd   + 1,193,313 wr)  
==11719== D1  misses:        78,407  (   13,698 rd   +    64,709 wr)  
==11719== LLd misses:        71,617  (    7,734 rd   +    63,883 wr)  
==11719== D1  miss rate:        1.0% (      0.2%     +       5.4%  )  
==11719== LLd miss rate:        0.9% (      0.1%     +       5.4%  )  
==11719==   
==11719== LL refs:           79,808  (   15,099 rd   +    64,709 wr)  
==11719== LL misses:         72,974  (    9,091 rd   +    63,883 wr)  
==11719== LL miss rate:         0.3% (      0.0%     +       5.4%  )  

</code></pre></div><p>特別注意D1 miss rate是1.0%。接下來是column major的code，如下。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> ; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1000</span> ; i<span style="color:#f92672">++</span> ){                                                              
    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> ; j <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1000</span> ; j<span style="color:#f92672">++</span> ){                                                                
        a[j][i] <span style="color:#f92672">=</span> i<span style="color:#f92672">+</span>j;                                                                          
    }                                                                                                 
} 
</code></pre></div><p>結果如下。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">==11522== Cachegrind, a cache and branch-prediction profiler  
==11522== Copyright (C) 2002-2015, and GNU GPL&#39;d, by Nicholas Nethercote et al.  
==11522== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info  
==11522== Command: ./tt  
==11522==   
--11522-- warning: L3 cache found, using its data for the LL simulation.  
==11522==   
==11522== I   refs:      16,204,946  
==11522== I1  misses:         1,401  
==11522== LLi misses:         1,357  
==11522== I1  miss rate:       0.01%  
==11522== LLi miss rate:       0.01%  
==11522==   
==11522== D   refs:       7,729,575  (6,536,262 rd   + 1,193,313 wr)  
==11522== D1  misses:     1,015,906  (   13,698 rd   + 1,002,208 wr)  
==11522== LLd misses:        71,617  (    7,734 rd   +    63,883 wr)  
==11522== D1  miss rate:       13.1% (      0.2%     +      84.0%  )  
==11522== LLd miss rate:        0.9% (      0.1%     +       5.4%  )  
==11522==   
==11522== LL refs:        1,017,307  (   15,099 rd   + 1,002,208 wr)  
==11522== LL misses:         72,974  (    9,091 rd   +    63,883 wr)  
==11522== LL miss rate:         0.3% (      0.0%     +       5.4%  )  

</code></pre></div><p>可以發現D1 miss rate大幅上升至13.1%。另外cachegrind一樣會產生output file，可以透過cg_annotate分析，或是用Kcahcegrind分析。</p>
<h3 id="callgrind"><strong>Callgrind</strong></h3>
<p>用來分析整個程式的function call數目。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$valgrind --tool<span style="color:#f92672">=</span>callgrind 程式名稱
</code></pre></div><p>這會開始執行你的程式，通常會執行的比較慢。在執行過程中，你可以透過<code>$callgrind_control -e -b</code>或是<code>$callgrind_control -b</code> 來看程式當下執行的function call backtrace。以下是費氏數列遞迴版結果。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext"> PID 6989: ./fb  
sending command status internal to pid 6989  
  
  Totals:           Ir   
   Th 1  2,560,275,485   
  
  Frame:             Ir Backtrace for Thread 1  
   [ 0]  23,685,553,356 fb(long long) (58138276 x)  
   [ 1]  41,379,358,433 fb(long long) (58138297 x)  
   [ 2]  41,379,358,449 fb(long long) (58138297 x)  
   [ 3]  41,379,358,465 fb(long long) (58138297 x)  
   [ 4]  41,379,358,481 fb(long long) (58138297 x)  
   [ 5]  41,379,358,497 fb(long long) (58138297 x)  
   [ 6]  41,379,358,513 fb(long long) (58138297 x)  
   [ 7]  41,379,358,529 fb(long long) (58138297 x)  
   [ 8]  41,379,358,545 fb(long long) (58138297 x)  
   [ 9]  23,685,553,523 fb(long long) (58138276 x)  
   [10]  41,379,364,892 fb(long long) (58138297 x)  
   [11]  41,379,364,908 fb(long long) (58138297 x)  
   [12]  41,379,364,924 fb(long long) (58138297 x)  
   [13]  23,685,559,902 fb(long long) (58138276 x)  
   [14]  23,685,630,165 fb(long long) (58138276 x)  
   [15]  41,379,619,162 fb(long long) (58138297 x)  
   [16]  41,379,619,178 fb(long long) (58138297 x)  
   [17]  41,379,619,194 fb(long long) (58138297 x)  
   [18]  41,379,619,210 fb(long long) (58138297 x)  
   [19]  23,685,814,188 fb(long long) (58138276 x)  
   [20]  41,382,920,321 fb(long long) (58138297 x)  
   [21]  41,382,920,337 fb(long long) (58138297 x)  
   [22]  23,689,115,315 fb(long long) (58138276 x)  
   [23]  41,405,546,424 fb(long long) (58138297 x)  
   [24]  41,405,546,440 fb(long long) (58138297 x)  
   [25]  23,711,741,418 fb(long long) (58138276 x)  
   [26]  41,560,627,883 fb(long long) (58138297 x)  
   [27]  23,866,822,861 fb(long long) (58138276 x)  
   [28]  24,523,758,344 fb(long long) (58138276 x)  
   [29]  43,937,442,813 fb(long long) (58138297 x)  
   [30]   2,558,084,449 fb(long long) (1 x)  
   [31]   2,558,084,465 fb(long long) (1 x)  
   [32]   2,558,084,472 main (1 x)  
   [33]   2,558,187,428 (below main) (1 x)  
   [34]   2,558,187,439 _start (1 x)  
   [35]               . 0x0000000000000d70 
</code></pre></div><p>可以看到執行當下的遞迴到哪裡，不過由於費氏數列浮動快，這用callgrind_control -e -b的深度會不同。要看到整個function的呼叫次數，可以透過callgrind執行完產生的calgrind.out.pid檔案，這時有兩種分析這個檔案的方式，一是透過<code>callgrind_annotate callgrind.out.pid</code> 來看結果，另一是用KCachegrind (KDE應用程式)。以下是KCachegrind結果，可以看到左下角的框框，fb被call了1+331160280次(第一層call+第二層以上call)。</p>
<p><a href="https://3.bp.blogspot.com/-YtNcOQY3fGA/WQHQhFGyhsI/AAAAAAAABik/Yz0Fpbrpxz0tOQnWkla-hoTo18z_WZv3ACLcB/s1600/Kcachegrind.png"><img src="https://3.bp.blogspot.com/-YtNcOQY3fGA/WQHQhFGyhsI/AAAAAAAABik/Yz0Fpbrpxz0tOQnWkla-hoTo18z_WZv3ACLcB/s640/Kcachegrind.png" alt=""></a></p>
<h3 id="heading"></h3>
<h3 id="helgrind"><strong>helgrind</strong></h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$valgrind --tool<span style="color:#f92672">=</span>helgrind
</code></pre></div><p>這次我們使用官方範例。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;pthread.h&gt;  </span><span style="color:#75715e">
</span><span style="color:#75715e"></span>  
<span style="color:#66d9ef">int</span> var <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;  
  
<span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> <span style="color:#a6e22e">child_fn</span> ( <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> arg ) {  
   var<span style="color:#f92672">++</span>; <span style="color:#75715e">/* Unprotected relative to parent */</span> <span style="color:#75715e">/* this is line 6 */</span>  
   <span style="color:#66d9ef">return</span> NULL;  
}  
  
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span> ( <span style="color:#66d9ef">void</span> ) {  
   pthread_t child;  
   pthread_create(<span style="color:#f92672">&amp;</span>child, NULL, child_fn, NULL);  
   var<span style="color:#f92672">++</span>; <span style="color:#75715e">/* Unprotected relative to child */</span> <span style="color:#75715e">/* this is line 13 */</span>  
   pthread_join(child, NULL);  
   <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;  
}  

</code></pre></div><p>很明顯的var沒有做mutex lock，會有race。結果如下。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">==19156== Helgrind, a thread error detector  
==19156== Copyright (C) 2007-2015, and GNU GPL&#39;d, by OpenWorks LLP et al.  
==19156== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info  
==19156== Command: ./race  
==19156==   
==19156== ---Thread-Announcement------------------------------------------  
==19156==   
==19156== Thread #1 is the program&#39;s root thread  
==19156==   
==19156== ---Thread-Announcement------------------------------------------  
==19156==   
==19156== Thread #2 was created  
==19156==    at 0x51427AE: clone (in /usr/lib/libc-2.24.so)  
==19156==    by 0x4E431A9: create_thread (in /usr/lib/libpthread-2.24.so)  
==19156==    by 0x4E44C12: pthread_create@@GLIBC_2.2.5 (in /usr/lib/libpthread-2.24.so)  
==19156==    by 0x4C31810: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)  
==19156==    by 0x4C328FD: pthread_create@* (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)  
==19156==    by 0x4005C6: main (in /home/tommycc/race)  
==19156==   
==19156== ----------------------------------------------------------------  
==19156==   
==19156== Possible data race during read of size 4 at 0x60103C by thread #1  
==19156== Locks held: none  
==19156==    at 0x4005C7: main (in /home/tommycc/race)  
==19156==   
==19156== This conflicts with a previous write of size 4 by thread #2  
==19156== Locks held: none  
==19156==    at 0x400597: child_fn (in /home/tommycc/race)  
==19156==    by 0x4C31A04: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)  
==19156==    by 0x4E44453: start_thread (in /usr/lib/libpthread-2.24.so)  
==19156==  Address 0x60103c is 0 bytes inside data symbol &#34;var&#34;  
==19156==   
==19156== ----------------------------------------------------------------  
==19156==   
==19156== Possible data race during write of size 4 at 0x60103C by thread #1  
==19156== Locks held: none  
==19156==    at 0x4005D0: main (in /home/tommycc/race)  
==19156==   
==19156== This conflicts with a previous write of size 4 by thread #2  
==19156== Locks held: none  
==19156==    at 0x400597: child_fn (in /home/tommycc/race)  
==19156==    by 0x4C31A04: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)  
==19156==    by 0x4E44453: start_thread (in /usr/lib/libpthread-2.24.so)  
==19156==  Address 0x60103c is 0 bytes inside data symbol &#34;var&#34;  
==19156==   
==19156==   
==19156== For counts of detected and suppressed errors, rerun with: -v  
==19156== Use --history-level=approx or =none to gain increased speed, at  
==19156== the cost of reduced accuracy of conflicting-access information  
==19156== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 0 from 0)  

</code></pre></div><p>她很明確得告訴我們有可能的race問題。而且名稱叫做var。結果十分直觀。</p>
<h3 id="massif"><strong>Massif</strong></h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ valgrind --tool<span style="color:#f92672">=</span>massif 程式名稱<span style="color:#e6db74">`</span>
</code></pre></div><p>他是用來分析data segement 中heap使用。<br>
heap在data sgment通常是由malloc等函式創造的，是適當的優化減少heap可以paging和盡量避開使用swap space。<br>
在執行完massif後會有一個massif.out.pid檔，可以透過ms_print來印出。不過一般高速運行的程式，他的malloc和free執行很快，在輸出圖形的時候看起來是一條線，所以可以透過<code>valgrind --tool=massif --time-unit=B 程式名稱</code> 讓massif透過allocate與deallcoate記憶體大小作圖。範例程式如下。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;stdio.h&gt;  </span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;stdlib.h&gt;  </span><span style="color:#75715e">
</span><span style="color:#75715e"></span>  
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()  
{  
    malloc(<span style="color:#ae81ff">1000</span>);  
    <span style="color:#66d9ef">int</span><span style="color:#f92672">*</span> a[<span style="color:#ae81ff">10</span>];  
    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> ; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">10</span> ; i<span style="color:#f92672">++</span> )  
        a[i] <span style="color:#f92672">=</span> malloc(<span style="color:#ae81ff">1000</span>);  
    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> ; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">10</span> ; i<span style="color:#f92672">++</span> )  
        free(a[i]);  
}  

</code></pre></div><p>結果如下。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">--------------------------------------------------------------------------------  
Command:            ./heap  
Massif arguments:   --time-unit=B  
ms_print arguments: massif.out.2213  
--------------------------------------------------------------------------------  
  
  
    KB  
10.91^                                     ####                                 
     |                                     #                                    
     |                                  :::#   :::                              
     |                                  :  #   :                                
     |                              @@@@:  #   :  ::::                          
     |                              @   :  #   :  :                             
     |                           :::@   :  #   :  :   :::                       
     |                           :  @   :  #   :  :   :                         
     |                        ::::  @   :  #   :  :   :  :::                    
     |                        :  :  @   :  #   :  :   :  :                      
     |                    :::::  :  @   :  #   :  :   :  :  ::::                
     |                 ::::   :  :  @   :  #   :  :   :  :  :   :::             
     |                 :  :   :  :  @   :  #   :  :   :  :  :   :               
     |             :::::  :   :  :  @   :  #   :  :   :  :  :   :  ::::         
     |             :   :  :   :  :  @   :  #   :  :   :  :  :   :  :            
     |          ::::   :  :   :  :  @   :  #   :  :   :  :  :   :  :   :::      
     |          :  :   :  :   :  :  @   :  #   :  :   :  :  :   :  :   :        
     |      :::::  :   :  :   :  :  @   :  #   :  :   :  :  :   :  :   :  :::   
     |      :   :  :   :  :   :  :  @   :  #   :  :   :  :  :   :  :   :  :     
     |   ::::   :  :   :  :   :  :  @   :  #   :  :   :  :  :   :  :   :  :  @  
   0 +-----------------------------------------------------------------------&gt;KB  
     0                                                                   20.84  
  
Number of snapshots: 23  
 Detailed snapshots: [9, 12 (peak), 22]  
  
--------------------------------------------------------------------------------  
  n        time(B)         total(B)   useful-heap(B) extra-heap(B)    stacks(B)  
--------------------------------------------------------------------------------  
  0              0                0                0             0            0  
  1          1,016            1,016            1,000            16            0  
  2          2,032            2,032            2,000            32            0  
  3          3,048            3,048            3,000            48            0  
  4          4,064            4,064            4,000            64            0  
  5          5,080            5,080            5,000            80            0  
  6          6,096            6,096            6,000            96            0  
  7          7,112            7,112            7,000           112            0  
  8          8,128            8,128            8,000           128            0  
  9          9,144            9,144            9,000           144            0  
98.43% (9,000B) (heap allocation functions) malloc/new/new[], --alloc-fns, etc.  
-&gt;87.49% (8,000B) 0x400569: main (in /home/tommycc/heap)  
|   
-&gt;10.94% (1,000B) 0x400556: main (in /home/tommycc/heap)  
  
--------------------------------------------------------------------------------  
  n        time(B)         total(B)   useful-heap(B) extra-heap(B)    stacks(B)  
--------------------------------------------------------------------------------  
 10         10,160           10,160           10,000           160            0  
 11         11,176           11,176           11,000           176            0  
 12         11,176           11,176           11,000           176            0  
98.43% (11,000B) (heap allocation functions) malloc/new/new[], --alloc-fns, etc.  
-&gt;89.48% (10,000B) 0x400569: main (in /home/tommycc/heap)  
|   
-&gt;08.95% (1,000B) 0x400556: main (in /home/tommycc/heap)  
  
--------------------------------------------------------------------------------  
  n        time(B)         total(B)   useful-heap(B) extra-heap(B)    stacks(B)  
--------------------------------------------------------------------------------  
 13         12,192           10,160           10,000           160            0  
 14         13,208            9,144            9,000           144            0  
 15         14,224            8,128            8,000           128            0  
 16         15,240            7,112            7,000           112            0  
 17         16,256            6,096            6,000            96            0  
 18         17,272            5,080            5,000            80            0  
 19         18,288            4,064            4,000            64            0  
 20         19,304            3,048            3,000            48            0  
 21         20,320            2,032            2,000            32            0  
 22         21,336            1,016            1,000            16            0  
98.43% (1,000B) (heap allocation functions) malloc/new/new[], --alloc-fns, etc.  
-&gt;98.43% (1,000B) 0x400556: main (in /home/tommycc/heap)  
|   
-&gt;00.00% (0B) in 1+ places, all below ms_print&#39;s threshold (01.00%  

</code></pre></div><p>可以看到malloc和free的作用。</p>
<h3 id="其他工具"><strong>其他工具</strong></h3>
<p>有些是valgrind的開發工具所以就跳過了。<br>
ref:<a href="http://valgrind.org/docs/manual/manual.html">http://valgrind.org/docs/manual/manual.html</a><br>
ㄧ<br>
ㄧ<br>
ㄧ</p>
<blockquote>
<p>Written with <a href="https://stackedit.io/">StackEdit</a>.</p>
</blockquote>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small"></span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://daichou.github.io/tags/note/">Note</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://daichou.github.io/posts/l3g4200-gyroscope/" data-tooltip="L3G4200 gyroscope使用筆記">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml"></span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://daichou.github.io/posts/stackedit/" data-tooltip="方便的網站：stackedit">
              
                  <span class="hide-xs hide-sm text-small icon-mr"></span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://daichou.github.io/posts/valgrindcc/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://daichou.github.io/posts/valgrindcc/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 Dai chou. 
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="1">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://daichou.github.io/posts/l3g4200-gyroscope/" data-tooltip="L3G4200 gyroscope使用筆記">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml"></span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://daichou.github.io/posts/stackedit/" data-tooltip="方便的網站：stackedit">
              
                  <span class="hide-xs hide-sm text-small icon-mr"></span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://daichou.github.io/posts/valgrindcc/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://daichou.github.io/posts/valgrindcc/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="1">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdaichou.github.io%2Fposts%2Fvalgrindcc%2F">
          <i class="fa fa-facebook-official"></i><span>%!(EXTRA string=Facebook)</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fdaichou.github.io%2Fposts%2Fvalgrindcc%2F">
          <i class="fa fa-twitter"></i><span>%!(EXTRA string=Twitter)</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.gravatar.com/avatar/b4129e5955793d76911ddfa9909e0f60?s=110" alt="" />
    
    <h4 id="about-card-name">Dai chou</h4>
    
      <div id="about-card-bio">A student major in Computer science in National Chiao Tung University.</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Student
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Taiwan
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://daichou.github.io/images/cover.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://daichou.github.io/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
  




    
  </body>
</html>

